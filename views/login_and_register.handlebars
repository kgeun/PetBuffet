<div class="container" style="margin-top:10%;margin-bottom:10%">
  <div class="row">
			<div class="col-md-6 offset-md-3">
                {{#if required}}
                <div class="jumbotron pt-2 pb-2">
                    <p><h5>{{login_message}}</h5></p>
                </div>
                {{/if}}
				<div class="card panel-login">
					<div class="card-header panel-heading">
						<div class="row text-center">
							<div class="col-md-6">
								<a href="#" class="active" id="login-form-link">로그인</a>
							</div>
							<div class="col-md-6">
								<a href="#" id="register-form-link">회원가입</a>
							</div>
						</div>
						<hr>
					</div>
					<div class="card-body">
						<div class="row">
							<div class="col-12">
                                <a id="gnbLogin" href="https://nid.naver.com/oauth2.0/authorize?response_type=token&amp;client_id=jyvqXeaVOVmV&amp;state=62d44264-662a-48e5-a270-4c1ab73edda8&amp;redirect_uri=http%3A%2F%2Fstatic.nid.naver.com%2Foauth%2Fsample%2Fcallback.html&amp;version=js-2.0.0&amp;svctype=1">Login</a>
								<form id="login-form" action="/user/login" method="post" role="form" style="display: block;">
                                    <input type="hidden" name="referer" value="{{referer}}"/>
									<div class="form-group">
										<input type="text" name="userid" id="login-userid" tabindex="1" class="form-control" placeholder="아이디">
									</div>
									<div class="form-group">
										<input type="password" name="password" id="login-password" tabindex="2" class="form-control" placeholder="패스워드">
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-md-6 offset-md-3">
												<input type="submit" name="login-submit" id="login-submit" tabindex="4" class="form-control btn btn-login" value="로그인">
                                                <div id="naverIdLogin"><a id="naverIdLogin_loginButton" href="https://static.nid.naver.com/oauth/sample/javascript_sample.html#"><img src="/images/big_g.PNG" height="60"></a>
											</div>
										</div>
									</div>
								</form>
								<form id="register-form" action="/user/register" method="post" role="form" style="display: none;">
									<div class="form-group">
										<input type="text" name="userid" id="register-userid" tabindex="1" class="form-control" placeholder="아이디" value="">
									</div>
									<div class="form-group">
										<input type="text" name="username" id="register-username" tabindex="1" class="form-control" placeholder="이름" value="">
									</div>
									<div class="form-group">
										<input type="password" name="password" id="register-password" tabindex="2" class="form-control" placeholder="패스워드">
									</div>
									<div class="form-group">
										<input type="password" name="confirm-password" id="register-confirm-password" tabindex="2" class="form-control" placeholder="패스워드 확인">
									</div>
									<div class="form-group">
										<div class="row">
											<div class="col-md-6 offset-md-3">
												<input type="submit" name="register-submit" id="register-submit" tabindex="4" class="form-control btn btn-register" value="회원가입하기">
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

<script>
  $(document).ready(function() {
    $(function() {
      $('#login-form-link').click(function(e) {
    		$("#login-form").delay(100).fadeIn(100);
     		$("#register-form").fadeOut(100);
    		$('#register-form-link').removeClass('active');
    		$(this).addClass('active');
    		e.preventDefault();
    	});
    	$('#register-form-link').click(function(e) {
    		$("#register-form").delay(100).fadeIn(100);
     		$("#login-form").fadeOut(100);
    		$('#login-form-link').removeClass('active');
    		$(this).addClass('active');
    		e.preventDefault();
    	});
    });

    $("#register-submit").on('click',function(e){
      e.preventDefault();
      if($("#register-confirm-password").prop("value") !== $("#register-password").prop("value")) {
        alert('비밀번호와 비밀번호 확인이 같지 않습니다.');
      } else {
        $.ajax({
            url:'/user/register',
            type:'post',
            data:$('#register-form').serialize(),
            success:function(data){
              alert(data.message);
              if(data.status == "OK"){
                location.href="/user/login";
              }
            }
        });
      }
    });

    $("#login-submit").on('click',function(e){
      e.preventDefault();
      $.ajax({
          url:'/user/login',
          type:'post',
          data:$('#login-form').serialize(),
          success:function(data){
            alert(data.message);
            if(data.status == "OK"){
                if(data.referer.endsWith("/user/login")) {
                    location.href="/";
                } else {
                    location.href=data.referer;
                }
            }
          }
      });
    });
  });

</script>
<!-- (2) LoginWithNaverId Javscript SDK -->
<script src="/js/naveridlogin_js_sdk_2.0.0.js"></script>

<!-- (3) LoginWithNaverId Javscript 설정 정보 및 초기화 -->
<script>

    var naverLogin = new naver.LoginWithNaverId(
        {
            clientId: "5zrkCm7BhUSMoIoBcZzv",
            callbackUrl: "http://localhost/",
            isPopup: false,
            loginButton: {color: "green", type: 3, height: 60}
        }
    );
    /* (4) 네아로 로그인 정보를 초기화하기 위하여 init을 호출 */
    naverLogin.init();

    /* (4-1) 임의의 링크를 설정해줄 필요가 있는 경우 */
    $("#gnbLogin").attr("href", naverLogin.generateAuthorizeUrl());

    /* (5) 현재 로그인 상태를 확인 */
    window.addEventListener('load', function () {
        naverLogin.getLoginStatus(function (status) {
            if (status) {
                /* (6) 로그인 상태가 "true" 인 경우 로그인 버튼을 없애고 사용자 정보를 출력합니다. */
                setLoginStatus();
            }
        });
    });

    /* (6) 로그인 상태가 "true" 인 경우 로그인 버튼을 없애고 사용자 정보를 출력합니다. */
    function setLoginStatus() {
        var profileImage = naverLogin.user.getProfileImage();
        var nickName = naverLogin.user.getNickName();
        $("#naverIdLogin_loginButton").html('<br><br><img src="' + profileImage + '" height=50 /> <p>' + nickName + '님 반갑습니다.</p>');
        $("#gnbLogin").html("Logout");
        $("#gnbLogin").attr("href", "#");
        /* (7) 로그아웃 버튼을 설정하고 동작을 정의합니다. */
        $("#gnbLogin").click(function () {
            naverLogin.logout();
            location.reload();
        });
    }
</script>
